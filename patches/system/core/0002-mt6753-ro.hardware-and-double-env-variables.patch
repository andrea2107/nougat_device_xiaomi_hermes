From 3313495975f6a53d0d4c95c48f3caaeaae466307 Mon Sep 17 00:00:00 2001
From: Moyster <oysterized@gmail.com>
Date: Thu, 3 Nov 2016 12:55:54 +0100
Subject: [PATCH] mt6753: ro.hardware and double env variables

---
 init/init.cpp | 6 ++++--
 init/init.h   | 2 +-
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/init/init.cpp b/init/init.cpp
index 480e630..00cda84 100755
--- a/init/init.cpp
+++ b/init/init.cpp
@@ -85,7 +85,9 @@ int have_console;
 std::string console_name = "/dev/console";
 static time_t process_needs_restart;
 
-const char *ENV[32];
+// xen0n: some MTK services (e.g. ril-daemon-mtk) require very large number
+// of sockets, which can't be contained in 32 entries minus other variables.
+const char *ENV[64];
 
 bool waiting_for_exec = false;
 
@@ -366,7 +368,7 @@ static void export_kernel_boot_props() {
         { "ro.boot.mode",       "ro.bootmode",   "unknown", },
         { "ro.boot.baseband",   "ro.baseband",   "unknown", },
         { "ro.boot.bootloader", "ro.bootloader", "unknown", },
-        { "ro.boot.hardware",   "ro.hardware",   "unknown", },
+        { "ro.boot.hardware",   "ro.hardware",   "mt6795", },
 #ifndef IGNORE_RO_BOOT_REVISION
         { "ro.boot.revision",   "ro.revision",   "0", },
 #endif
diff --git a/init/init.h b/init/init.h
index 345d442..f93d0c5 100644
--- a/init/init.h
+++ b/init/init.h
@@ -24,7 +24,7 @@ class Service;
 
 #define COMMAND_RETRY_TIMEOUT 5
 
-extern const char *ENV[32];
+extern const char *ENV[64];
 extern bool waiting_for_exec;
 extern int have_console;
 extern std::string console_name;
-- 
2.9.3

